## Dany jest idealny równomierny 9-bitowy kwantyzator 𝑞(𝑥), którego najmniejszy poziom kwantyzacji ma wartość 𝑎=−0.6, 
## natomist największy poziom kwantyzacji ma wartość 𝑏=0.98. Oblicz sygnał błędu kwantyzacji tego przetwornika dla dyskretnego sygnału 𝑥∈𝑅92. 
## Jako rozwiązanie podaj moc sygnału błędu kwantyzacji.

function rozwiazanie(;

    #wynik 0.008070915416286748 , podac moc, 5-bit git 0.008070915416286748
    #a::Float64 = -6.0,
    #b::Float64 = 4.6,
    #x::Vector{Float64} = [-4.96014, -4.04121, -3.13877, -2.24068, -1.33695, -0.41963, 0.51587, 1.47078, 2.44763, 3.50782, -5.64309, -4.60522, -3.66279, -2.74661, -1.84305, -0.94127, -0.03115, 0.8957, 1.84638, 2.83906, 4.58243, -5.24436, -4.23709, -3.28413, -2.35677, -1.44649, -0.54451, 0.35937, 1.27575, 2.21676, 3.22554, -6.01562, -4.84664, -3.86223, -2.90524, -1.96896, -1.05118, -0.1469, 0.75213, 1.65618, 2.57799, 3.57306, -5.43577, -4.44928, -3.48307, -2.52605, -1.58297, -0.65731, 0.25136, 1.14743, 2.0371, 2.91803, -5.89256, -4.98778, -4.05173, -3.1007, -2.14638, -1.19861, -0.26504, 0.65008, 1.54576, 2.41849, 3.17722, -5.40512],

    #ywnik 0.18259452743673468, 3 bit, podac energie git 0.18259452743673468
    a::Float64 = 0.011,
    b::Float64 = 0.99,
    x::Vector{Float64} = [0.90798, 0.56913, 0.44667, 0.03897, 0.92721, 0.52887, 0.49187, 0.08137, 0.6328, 0.31377, 0.57614, 0.78384, 0.58475, 0.5626, 0.03781, 0.52073, 0.41188, 0.16673, 0.60371, 0.37653, 0.16885, 0.02363, 0.18805, 0.11251, 0.63835, 0.82362, 0.71251, 0.09439, 0.80113, 0.34575, 0.19211, 0.19708, 0.79358, 0.68517, 0.48758, 0.33059, 0.64093, 0.07079, 0.08695, 0.62442, 0.79468, 0.48913, 0.06455, 0.31842, 0.28905, 0.39223, 0.61332, 0.0703, 0.17544, 0.1989, 0.91248, 0.92223, 0.32868, 0.0384, 0.95976, 0.39816, 0.55051, 0.61491, 0.43551, 0.1003, 0.34273, 0.54258, 0.54092, 0.92302, 0.34515, 0.17436, 0.50054, 0.23767, 0.27606, 0.58653, 0.39819, 0.79276, 0.3136, 0.39789, 0.21132, 0.77697, 0.35035, 0.49717, 0.26729, 0.76688, 0.50657, 0.15117, 0.60267, 0.25257, 0.01077, 0.43203, 0.10098, 0.34206, 0.21874, 0.98701, 0.94863, 0.98381],


    #wynik 5.318125467803138e-5 podac moc sygnału bledu, 5-bit git 5.318125467803138e-5
    #a::Float64 = 0.21,
    #b::Float64 = 0.99,
    #x::Vector{Float64} = [0.976, 0.93543, 0.89486, 0.85428, 0.81371, 0.77314, 0.73257, 0.69199, 0.65142, 0.61085, 0.57028, 0.52971, 0.48913, 0.44856, 0.40799, 0.36742, 0.32685, 0.28627, 0.2457, 0.20513, 0.96456, 0.92398, 0.88341, 0.84284, 0.80227, 0.7617, 0.72112, 0.68055, 0.63998, 0.59941, 0.55883, 0.51826, 0.47769, 0.43712, 0.39655, 0.35597, 0.3154, 0.27483, 0.23426, 0.99369, 0.95311, 0.91254, 0.87197, 0.8314, 0.79082, 0.75025, 0.70968, 0.66911, 0.62854, 0.58796, 0.54739, 0.50682, 0.46625, 0.42567, 0.3851, 0.34453, 0.30396, 0.26339, 0.22281, 0.98224, 0.94167, 0.9011, 0.86053, 0.81995, 0.77938, 0.73881, 0.69824, 0.65766],
    )
    
    L = range(; start=a, stop=b, length=2^3)
    quantize(L::AbstractVector)::Function = x -> L[argmin(abs.(-L .+ x))]
    q = quantize(L)
    x_quantized = q.(x)
    quantization_error = x .- x_quantized
    energy = sum(abs2, quantization_error)
    #power = sum(abs2, quantization_error)/length(quantization_error)

    return energy
end

println(rozwiazanie())